with months as ( select (cast(month(current_date-interval '4' month) as INTEGER),cast(year(current_date-interval '4' month) as INTEGER)) union all select (cast(month(current_date-interval '3' month) as INTEGER),cast(year(current_date-interval '3' month) as INTEGER)) union all select (cast(month(current_date-interval '2' month) as INTEGER),cast(year(current_date-interval '2' month) as INTEGER)) union all select (cast(month(current_date-interval '1' month) as INTEGER),cast(year(current_date-interval '1' month) as INTEGER)) ), top100 as ( SELECT * FROM refdata.top_account_201708 limit 100 ), t1 as ( with y as  (SELECT accountid,date_trunc('hour',stoptime) AS hourstamp, CASE     WHEN firstopcodedesc = 'sendAuthenticationInfo' THEN 'countSAI'     WHEN firstopcodedesc = 'updateLocation' THEN 'countUL'     WHEN firstopcodedesc = 'updateGprsLocation' THEN 'countUGL'     WHEN firstopcodedesc = 'cancelLocation' THEN 'countCL'     WHEN firstopcodedesc is null THEN 'mapsum'  END as metric, count(1) value FROM signaling_20171018_112152.mapdata where firstopcodedesc is not null and accountid in (select accountid from top100)  and (month,year) in (select * from months) GROUP BY accountid,2,rollup(firstopcodedesc) ) select * from y where metric!='' ), t2 as( SELECT accountid,date_trunc('hour',stoptime) AS hourstamp, 'createPdpCountV1' as metric, SUM(CASE WHEN causecode= 128 AND recordtype = 1 THEN 1 ELSE 0 END) AS value FROM signaling_20171018_112152.gtpv1  where accountid in (select accountid from top100) and (month,year) in (select * from months) GROUP BY 1,2,3 union SELECT accountid,date_trunc('hour',stoptime) AS hourstamp, 'createPdpCountV2' as metric, SUM(CASE WHEN causecode= 128 AND recordtype = 1 THEN 1 ELSE 0 END) AS value FROM signaling_20171018_112152.gtpv2 where accountid in (select accountid from top100) and (month,year) in (select * from months) GROUP BY 1,2,3 ), t3 as( SELECT accountid,date_trunc('hour',stoptime) AS hourstamp, 'imsiSum' as metric,count(distinct(imsi)) value FROM signaling_20171018_112152.gtpv1 where accountid in (select accountid from top100) and (month,year) in (select * from months) GROUP BY 1,2,3 ) select accountid,hourstamp,extract(DAY_OF_WEEK FROM hourstamp) as day_of_week,metric,value from  (select * from t1 union select * from t2 union select * from t3) t_all order by hourstamp,accountid,metric
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: RUNNING
query state: SUCCEEDED
prediction/training-data/e7000802-f517-4763-8cd4-655e8f925888.csv
reformat progress:  0.00%
reformat progress:  0.60%
reformat progress:  1.19%
reformat progress:  1.79%
reformat progress:  2.38%
reformat progress:  2.98%
reformat progress:  3.57%
reformat progress:  4.17%
reformat progress:  4.76%
reformat progress:  5.36%
reformat progress:  5.95%
reformat progress:  6.55%
reformat progress:  7.14%
reformat progress:  7.74%
reformat progress:  8.33%
reformat progress:  8.93%
reformat progress:  9.52%
reformat progress:  10.12%
reformat progress:  10.71%
reformat progress:  11.31%
reformat progress:  11.90%
reformat progress:  12.50%
reformat progress:  13.10%
reformat progress:  13.69%
reformat progress:  14.29%
reformat progress:  14.88%
reformat progress:  15.48%
reformat progress:  16.07%
reformat progress:  16.67%
reformat progress:  17.26%
reformat progress:  17.86%
reformat progress:  18.45%
reformat progress:  19.05%
reformat progress:  19.64%
reformat progress:  20.24%
reformat progress:  20.83%
reformat progress:  21.43%
reformat progress:  22.02%
reformat progress:  22.62%
reformat progress:  23.21%
reformat progress:  23.81%
reformat progress:  24.40%
reformat progress:  25.00%
reformat progress:  25.60%
reformat progress:  26.19%
reformat progress:  26.79%
reformat progress:  27.38%
reformat progress:  27.98%
reformat progress:  28.57%
reformat progress:  29.17%
reformat progress:  29.76%
reformat progress:  30.36%
reformat progress:  30.95%
reformat progress:  31.55%
reformat progress:  32.14%
reformat progress:  32.74%
reformat progress:  33.33%
reformat progress:  33.93%
reformat progress:  34.52%
reformat progress:  35.12%
reformat progress:  35.71%
reformat progress:  36.31%
reformat progress:  36.90%
reformat progress:  37.50%
reformat progress:  38.10%
reformat progress:  38.69%
reformat progress:  39.29%
reformat progress:  39.88%
reformat progress:  40.48%
reformat progress:  41.07%
reformat progress:  41.67%
reformat progress:  42.26%
reformat progress:  42.86%
reformat progress:  43.45%
reformat progress:  44.05%
reformat progress:  44.64%
reformat progress:  45.24%
reformat progress:  45.83%
reformat progress:  46.43%
reformat progress:  47.02%
reformat progress:  47.62%
reformat progress:  48.21%
reformat progress:  48.81%
reformat progress:  49.40%
reformat progress:  50.00%
reformat progress:  50.60%
reformat progress:  51.19%
reformat progress:  51.79%
reformat progress:  52.38%
reformat progress:  52.98%
reformat progress:  53.57%
reformat progress:  54.17%
reformat progress:  54.76%
reformat progress:  55.36%
reformat progress:  55.95%
reformat progress:  56.55%
reformat progress:  57.14%
reformat progress:  57.74%
reformat progress:  58.33%
reformat progress:  58.93%
reformat progress:  59.52%
reformat progress:  60.12%
reformat progress:  60.71%
reformat progress:  61.31%
reformat progress:  61.90%
reformat progress:  62.50%
reformat progress:  63.10%
reformat progress:  63.69%
reformat progress:  64.29%
reformat progress:  64.88%
reformat progress:  65.48%
reformat progress:  66.07%
reformat progress:  66.67%
reformat progress:  67.26%
reformat progress:  67.86%
reformat progress:  68.45%
reformat progress:  69.05%
reformat progress:  69.64%
reformat progress:  70.24%
reformat progress:  70.83%
reformat progress:  71.43%
reformat progress:  72.02%
reformat progress:  72.62%
reformat progress:  73.21%
reformat progress:  73.81%
reformat progress:  74.40%
reformat progress:  75.00%
reformat progress:  75.60%
reformat progress:  76.19%
reformat progress:  76.79%
reformat progress:  77.38%
reformat progress:  77.98%
reformat progress:  78.57%
reformat progress:  79.17%
reformat progress:  79.76%
reformat progress:  80.36%
reformat progress:  80.95%
reformat progress:  81.55%
reformat progress:  82.14%
reformat progress:  82.74%
reformat progress:  83.33%
reformat progress:  83.93%
reformat progress:  84.52%
reformat progress:  85.12%
reformat progress:  85.71%
reformat progress:  86.31%
reformat progress:  86.90%
reformat progress:  87.50%
reformat progress:  88.10%
reformat progress:  88.69%
reformat progress:  89.29%
reformat progress:  89.88%
reformat progress:  90.48%
reformat progress:  91.07%
reformat progress:  91.67%
reformat progress:  92.26%
reformat progress:  92.86%
reformat progress:  93.45%
reformat progress:  94.05%
reformat progress:  94.64%
reformat progress:  95.24%
reformat progress:  95.83%
reformat progress:  96.43%
reformat progress:  97.02%
reformat progress:  97.62%
reformat progress:  98.21%
reformat progress:  98.81%
reformat progress:  99.40%
